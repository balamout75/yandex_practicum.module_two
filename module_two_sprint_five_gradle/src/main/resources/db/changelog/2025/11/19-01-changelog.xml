<?xml version="1.0" encoding="UTF-8"?>
<databaseChangeLog
        xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog
                      http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-4.31.xsd"
        objectQuotingStrategy="QUOTE_ONLY_RESERVED_WORDS">
    <changeSet id="1763516374436-1" author="Иван">
        <createSequence incrementBy="1" sequenceName="cards_id_seq" startValue="1"/>
    </changeSet>
    <changeSet id="1763516374436-2" author="Иван">
        <createSequence incrementBy="1" sequenceName="cards_id_seq1" startValue="1"/>
    </changeSet>
    <changeSet id="1763516374436-3" author="Иван">
        <createSequence incrementBy="1" sequenceName="cards_user_id_seq" startValue="1"/>
    </changeSet>
    <changeSet id="1763516374436-4" author="Иван">
        <createSequence incrementBy="1" sequenceName="items_id_seq" startValue="1"/>
    </changeSet>
    <changeSet id="1763516374436-5" author="Иван">
        <createSequence incrementBy="1" sequenceName="items_id_seq1" startValue="1"/>
    </changeSet>
    <changeSet id="1763516374436-6" author="Иван">
        <createSequence incrementBy="1" sequenceName="orders_id_seq" startValue="1"/>
    </changeSet>
    <changeSet id="1763516374436-7" author="Иван">
        <createSequence incrementBy="1" sequenceName="orders_id_seq1" startValue="1"/>
    </changeSet>
    <changeSet id="1763516374436-8" author="Иван">
        <createSequence incrementBy="1" sequenceName="users_id_seq" startValue="1"/>
    </changeSet>
    <changeSet id="1763516374436-9" author="Иван">
        <createSequence incrementBy="1" sequenceName="users_id_seq1" startValue="1"/>
    </changeSet>
    <changeSet id="1763516374436-10" author="Иван">
        <createTable tableName="cards">
            <column autoIncrement="true" name="id" type="BIGINT">
                <constraints nullable="false" primaryKey="true" primaryKeyName="cards_pkey"/>
            </column>
        </createTable>
    </changeSet>
    <changeSet id="1763516374436-11" author="Иван">
        <createTable tableName="in_card">
            <column defaultValueNumeric="1" name="card_id" type="BIGINT">
                <constraints nullable="false" primaryKey="true" primaryKeyName="in_card_pkey"/>
            </column>
            <column name="item_id" type="BIGINT">
                <constraints nullable="false" primaryKey="true" primaryKeyName="in_card_pkey"/>
            </column>
        </createTable>
    </changeSet>
    <changeSet id="1763516374436-12" author="Иван">
        <createTable tableName="in_order">
            <column name="order_id" type="BIGINT">
                <constraints nullable="false" primaryKey="true" primaryKeyName="in_order_pkey"/>
            </column>
            <column defaultValueNumeric="1" name="item_id" type="BIGINT">
                <constraints nullable="false" primaryKey="true" primaryKeyName="in_order_pkey"/>
            </column>
        </createTable>
    </changeSet>
    <changeSet id="1763516374436-13" author="Иван">
        <createTable tableName="items">
            <column autoIncrement="true" name="id" type="BIGINT">
                <constraints nullable="false" primaryKey="true" primaryKeyName="items_pkey"/>
            </column>
            <column name="title" type="VARCHAR">
                <constraints nullable="false"/>
            </column>
            <column name="description" type="VARCHAR">
                <constraints nullable="false"/>
            </column>
            <column name="price" type="NUMBER(10, 2)">
                <constraints nullable="false"/>
            </column>
            <column defaultValueNumeric="0" name="quantity" type="BIGINT"/>
            <column name="imgpath" type="VARCHAR">
                <constraints nullable="false"/>
            </column>
        </createTable>
    </changeSet>
    <changeSet id="1763516374436-14" author="Иван">
        <createTable tableName="orders">
            <column autoIncrement="true" name="id" type="BIGINT">
                <constraints nullable="false" primaryKey="true" primaryKeyName="orders_pkey"/>
            </column>
            <column defaultValueComputed="CURRENT_TIMESTAMP" name="created_at" type="timestamp"/>
            <column defaultValueNumeric="1" name="user_id" type="BIGINT">
                <constraints nullable="false"/>
            </column>
        </createTable>
    </changeSet>
    <changeSet id="1763516374436-15" author="Иван">
        <createTable tableName="users">
            <column autoIncrement="true" name="id" type="BIGINT">
                <constraints nullable="false" primaryKey="true" primaryKeyName="users_pkey"/>
            </column>
            <column name="firstname" type="VARCHAR">
                <constraints nullable="false"/>
            </column>
            <column name="lastname" type="VARCHAR">
                <constraints nullable="false"/>
            </column>
            <column defaultValueBoolean="true" name="available" type="BOOLEAN"/>
            <column defaultValueComputed="CURRENT_TIMESTAMP" name="created_at" type="timestamp"/>
        </createTable>
    </changeSet>
    <changeSet id="1763516374436-16" author="Иван">
        <addForeignKeyConstraint baseColumnNames="id" baseTableName="cards" constraintName="cards_id_fkey"
                                 onDelete="CASCADE" referencedColumnNames="id" referencedTableName="users"/>
    </changeSet>
    <changeSet id="1763516374436-17" author="Иван">
        <addForeignKeyConstraint baseColumnNames="card_id" baseTableName="in_card" constraintName="in_card_card_id_fkey"
                                 onDelete="CASCADE" referencedColumnNames="id" referencedTableName="cards"/>
    </changeSet>
    <changeSet id="1763516374436-18" author="Иван">
        <addForeignKeyConstraint baseColumnNames="item_id" baseTableName="in_card" constraintName="in_card_item_id_fkey"
                                 onDelete="CASCADE" referencedColumnNames="id" referencedTableName="items"/>
    </changeSet>
    <changeSet id="1763516374436-19" author="Иван">
        <addForeignKeyConstraint baseColumnNames="item_id" baseTableName="in_order"
                                 constraintName="in_order_item_id_fkey" onDelete="CASCADE" referencedColumnNames="id"
                                 referencedTableName="items"/>
    </changeSet>
    <changeSet id="1763516374436-20" author="Иван">
        <addForeignKeyConstraint baseColumnNames="order_id" baseTableName="in_order"
                                 constraintName="in_order_order_id_fkey" onDelete="CASCADE" referencedColumnNames="id"
                                 referencedTableName="orders"/>
    </changeSet>
    <changeSet id="1763516374436-21" author="Иван">
        <addForeignKeyConstraint baseColumnNames="user_id" baseTableName="orders" constraintName="orders_user_id_fkey"
                                 onDelete="CASCADE" referencedColumnNames="id" referencedTableName="users"/>
    </changeSet>

</databaseChangeLog>